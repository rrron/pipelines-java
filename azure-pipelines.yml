# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

trigger:
- main
- maven
- master
- feature/*

pool:
  vmImage: ubuntu-latest

stages:
- stage: Setup
  jobs:
  - template: components/ExtractAssemblyVersion.yml

# - stage: BuildAndTest
#   jobs:
#   - job: BuildAndTest
#     steps:
#     - template: components/maven.yml
#   - job: Python
#     steps:
#     - template: components/python.yml
#   - job: GithubPrComment
#     steps:
#     - template: components/github-pr-comment.yml

- stage: DockerBuild
  jobs:
- ${{each tag in parameters.personaltag}}:
  - job: Build
    steps:
    - script: |
        mkdir -p dockerfolder/static-html-directory/
      displayName: Create static-html-directory

    - template: components/build-docker.yml
      parameters:
        dockerfilename: 'dockerfolder/Dockerfile'
        personaltag: '$(tag)'